<!DOCTYPE html>
<html>
<head>
	<title>Chunk v2.0 Config</title>
	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	
	<link href="css/bootstrap.min.css" rel="stylesheet">
	<link href="css/bootstrap-theme.min.css" rel="stylesheet">
	
	<script src="js/modernizr.custom.51767.js"></script>
	<script src="js/jquery.min.js"></script>
	<script src="js/bootstrap.min.js"></script>
	
</head>
<body>

    <script>
      (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
      })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

      ga('create', 'UA-62811138-1', 'auto');
      ga('send', 'pageview');

    </script>

    <div class="container">

	  <h2>Chunk v2.0</h2>
      
      <form id="configure-form" class="form-configure well" action="#" method="POST">
	  
        <h4>Build Style</h4>
        <p><small>Choose your favourite build style.</small></p>
        <div class="btn-group" data-toggle="buttons">
          <label class="btn btn-primary">
            <input type="radio" name="style" id="style1" value="1"> BlackOnWhite
          </label>
          <label class="btn btn-primary">
            <input type="radio" name="style" id="style2" value="2"> Split1(WhiteTop)
          </label>
          <label class="btn btn-primary">
            <input type="radio" name="style" id="style3" value="3"> WhiteOnBlack
          </label>
          <label class="btn btn-primary">
            <input type="radio" name="style" id="style4" value="4"> Split2(BlackTop)
          </label>
        </div>
        <hr />
		
        <h4>Bluetooth Vibe</h4>
        <p><small>Vibrate on Bluetooth disconnect.</small></p>
        <div class="btn-group" data-toggle="buttons">
          <label class="btn btn-primary">
            <input type="radio" name="bluetoothvibe" id="bluetoothvibe1" value="1"> Yes
          </label>
          <label class="btn btn-primary">
            <input type="radio" name="bluetoothvibe" id="bluetoothvibe2" value="0"> No
          </label>
        </div>
        <hr />
		
        <h4>Hourly Vibe</h4>
        <p><small>Vibrate on the hour.</small></p>
        <div class="btn-group" data-toggle="buttons">
          <label class="btn btn-primary">
            <input type="radio" name="hourlyvibe" id="hourlyvibe1" value="1"> Yes
          </label>
          <label class="btn btn-primary">
            <input type="radio" name="hourlyvibe" id="hourlyvibe2" value="0"> No
          </label>
        </div>
        <hr />
		
        <h4>Units</h4>
        <p><small>Celsius or Fahrenheit</small></p>
        <div class="btn-group" data-toggle="buttons">
          <label class="btn btn-primary">
            <input type="radio" name="units" id="units1" value="1"> Celsius
          </label>
          <label class="btn btn-primary">
            <input type="radio" name="units" id="units2" value="0"> Fahrenheit
          </label>
        </div>
        <hr />
		
        <h4>Blink</h4>
        <p><small>The colon between the hours and minutes will blink every second.</small></p>
        <div class="btn-group" data-toggle="buttons">
          <label class="btn btn-primary">
            <input type="radio" name="blink" id="blink1" value="1"> Yes
          </label>
          <label class="btn btn-primary">
            <input type="radio" name="blink" id="blink2" value="0"> No
          </label>
        </div>
        <hr />
		
        <h4>Date Format</h4>
        <p><small>Control the date appearance. (will add more options at some point)</small></p>
        <div class="btn-group" data-toggle="buttons">
          <label class="btn btn-primary">
            <input type="radio" name="dateformat" id="dateformat1" value="1"> No Suffix
          </label>
          <label class="btn btn-primary">
            <input type="radio" name="dateformat" id="dateformat2" value="0"> Default
          </label>
        </div>
        <hr />
		
        <h4>Language</h4>
        <p><small>Localise to your language. (contact me if you want other languages)</small></p>
        <div class="btn-group" data-toggle="buttons">
          <label class="btn btn-primary">
              <select id="language">
				<option value="0">English</option>
				<option value="1">Italian</option>
				<option value="2">German</option>
				<option value="3">French</option>
				<option value="4">Russian</option>
			  </select>
		  </label>
        </div>
        <hr />
	  
        <h4>Fixed GPS</h4>
        <p><small>If set, always use these GPS coordinates for the weather instead of GPS. <br />
		Enter specific GPS coordinates, or click 'Current Location' to use your current GPS position. <br />
		Click 'Auto Location' to always lookup your current position automatically.</small></p>
        <div class="btn-group" data-toggle="buttons">
          <label class="btn btn-primary">
            <input type="text" name="gpslat" id="gpslat" value=""> Latitude
          </label>
          <label class="btn btn-primary">
            <input type="text" name="gpslon" id="gpslon" value=""> Longitude
          </label><div class="clearfix"></div><br />
		  <input type="button" id="GetCoords" value="Current Location" class="btn btn-warning" />
		  <input type="button" id="ClearCoords" value="Auto Location" class="btn btn-danger" />
        </div>
      
        <hr />

        <div class="clearfix">
					<script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
					<!-- Pebble -->
					<ins class="adsbygoogle"
					     style="display:block"
					     data-ad-client="ca-pub-5617121309965916"
					     data-ad-slot="7637739388"
					     data-ad-format="auto"></ins>
					<script>
					(adsbygoogle = window.adsbygoogle || []).push({});
					</script>

        </div>
        <br />

		
        <div class="clearfix">
          <input class="btn btn-lg btn-primary btn-block" id="save" type="submit" value="Save"/>
        </div>
      </form>
	  </div>

    <div class="footer container">
    	<p>Chunk Weather v2.5 by <a href="http://twitter.com/orviwan">orviwan</a></p>
		
      <hr />

      <form action="https://www.paypal.com/cgi-bin/webscr" method="post" target="_blank" class="form-configure well" >
        <input type="hidden" name="cmd" value="_s-xclick" />
        <input type="hidden" name="hosted_button_id" value="93YLEYE2PW2TS" />
        <input type="hidden" name="on0" value="Gift" />
        <h4>Donate</h4>
        <p>I do this for love, but sometimes we all need a bit of encouragement (and bacon).</p>
        <select name="os0"  class="form-control">
          <option value="Thanks">2 rashers of bacon &pound;0.50 GBP</option>
          <option value="Much love">Bacon sandwich &pound;1.00 GBP</option>
          <option value="OMG">Full English breakfast &pound;5.00 GBP</option>
        </select><br />

        <input type="hidden" name="currency_code" value="GBP" />
        <input type="image" src="https://www.paypalobjects.com/en_US/GB/i/btn/btn_buynowCC_LG.gif" border="0" name="submit" alt="PayPal â€“ The safer, easier way to pay online." />
        <img alt="" border="0" src="https://www.paypalobjects.com/en_GB/i/scr/pixel.gif" width="1" height="1" />
      </form>
				
		<br />

    </div>
    
	<script>

    // Something like this to get query variables.
    function getQueryParam(variable, default_) {
      var query = location.search.substring(1);
      var vars = query.split('&');
      for (var i = 0; i < vars.length; i++) {
          var pair = vars[i].split('=');
          if (pair[0] == variable)
              return decodeURIComponent(pair[1]);
      }
      return default_ || false;
    }   
	
	$("#GetCoords").click(function() {
		get_location();
	});
	$("#ClearCoords").click(function() {
		clear_location();
	});	
	function get_location() {
	  if (Modernizr.geolocation) {
		navigator.geolocation.getCurrentPosition(locationSuccess);
	  }
	}
	function clear_location() {
		$("#gpslat").val('');
		$("#gpslon").val('');
	}
	function locationSuccess(position) {
		if(position) {
			$("#gpslat").val(Number(position.coords.latitude).toFixed(5));
			$("#gpslon").val(Number(position.coords.longitude).toFixed(5));
		}
	}
      var mStyle;
      var mBluetoothvibe;
      var mHourlyvibe;
      var mUnits;
	  var mBlink;
	  var mDateFormat;
	  var mGpsLat;
	  var mGpsLon;
	  var mLanguage;
      
      $().ready(function () {

        mStyle = parseInt(localStorage.getItem("style"));      
        mBluetoothvibe = parseInt(localStorage.getItem("bluetoothvibe"));
        mHourlyvibe = parseInt(localStorage.getItem("hourlyvibe"));
        mUnits = parseInt(localStorage.getItem("units"));
		mBlink = parseInt(localStorage.getItem("blink"));
		mDateFormat = parseInt(localStorage.getItem("dateformat"));
		mLanguage = parseInt(localStorage.getItem("language"));
        mGpsLat = localStorage.getItem("gpslat");
		mGpsLon = localStorage.getItem("gpslon");
		
        if(isNaN(mStyle)) {
          mStyle = 1;
        }
        if(isNaN(mBluetoothvibe)) {
          mBluetoothvibe = 0;
        }
        if(isNaN(mHourlyvibe)) {
          mHourlyvibe = 0;
        }        
        if(isNaN(mUnits)) {
          mUnits = 0;
        }       
        if(isNaN(mBlink)) {
          mBlink = 0;
        }  
        if(isNaN(mDateFormat)) {
          mDateFormat = 0;
        }  
        if(isNaN(mLanguage)) {
          mLanguage = 0;
        }  
		
		$("#gpslat").val(mGpsLat);
		$("#gpslon").val(mGpsLon);
        
        
        $('#style1').prop('checked', false);
        $('#style1').parent().removeClass('active');
        $('#style2').prop('checked', false);
        $('#style2').parent().removeClass('active');
        $('#style3').prop('checked', false);
        $('#style3').parent().removeClass('active');
        $('#style4').prop('checked', false);
        $('#style4').parent().removeClass('active');

        switch(mStyle) {
          case 1:
            $('#style1').prop('checked', true);
            $('#style1').parent().addClass('active');
            break;
          case 2:
            $('#style2').prop('checked', true);
            $('#style2').parent().addClass('active');
            break;
          case 3:
            $('#style3').prop('checked', true);
            $('#style3').parent().addClass('active');
            break;
          case 4:
            $('#style4').prop('checked', true);
            $('#style4').parent().addClass('active');
            break;        
        }

        
        if(mBluetoothvibe) {
          $('#bluetoothvibe1').prop('checked', true);
          $('#bluetoothvibe1').parent().addClass('active');
          
          $('#bluetoothvibe2').prop('checked', false);
          $('#bluetoothvibe2').parent().removeClass('active');
        } 
        else {
          $('#bluetoothvibe1').prop('checked', false);
          $('#bluetoothvibe1').parent().removeClass('active');
          
          $('#bluetoothvibe2').prop('checked', true);
          $('#bluetoothvibe2').parent().addClass('active'); 
        }
        
        
        if(mHourlyvibe) {
          $('#hourlyvibe1').prop('checked', true);
          $('#hourlyvibe1').parent().addClass('active');
          
          $('#hourlyvibe2').prop('checked', false);
          $('#hourlyvibe2').parent().removeClass('active');
        } 
        else {
          $('#hourlyvibe1').prop('checked', false);
          $('#hourlyvibe1').parent().removeClass('active');
          
          $('#hourlyvibe2').prop('checked', true);
          $('#hourlyvibe2').parent().addClass('active'); 
        }
        
                
        if(mUnits) {
          $('#units1').prop('checked', true);
          $('#units1').parent().addClass('active');
          
          $('#units2').prop('checked', false);
          $('#units2').parent().removeClass('active');
        } 
        else {
          $('#units1').prop('checked', false);
          $('#units1').parent().removeClass('active');
          
          $('#units2').prop('checked', true);
          $('#units2').parent().addClass('active'); 
        }
		
        if(mBlink) {
          $('#blink1').prop('checked', true);
          $('#blink1').parent().addClass('active');
          
          $('#blink2').prop('checked', false);
          $('#blink2').parent().removeClass('active');
        } 
        else {
          $('#blink1').prop('checked', false);
          $('#blink1').parent().removeClass('active');
          
          $('#blink2').prop('checked', true);
          $('#blink2').parent().addClass('active'); 
        }
		
        if(mDateFormat) {
          $('#dateformat1').prop('checked', true);
          $('#dateformat1').parent().addClass('active');
          
          $('#dateformat2').prop('checked', false);
          $('#dateformat2').parent().removeClass('active');
        } 
        else {
          $('#dateformat1').prop('checked', false);
          $('#dateformat1').parent().removeClass('active');
          
          $('#dateformat2').prop('checked', true);
          $('#dateformat2').parent().addClass('active'); 
        }
		
		$('#language').prop("selectedIndex",mLanguage);

      });

      $("#configure-form").submit(function(e) {  

        mStyle = $('#style1').prop('checked') ? 1 : 0;
        mStyle = $('#style2').prop('checked') ? 2 : mStyle;
        mStyle = $('#style3').prop('checked') ? 3 : mStyle;
        mStyle = $('#style4').prop('checked') ? 4 : mStyle;
        
        mBluetoothvibe = $('#bluetoothvibe1').prop('checked') ? 1 : 0;
        mHourlyvibe = $('#hourlyvibe1').prop('checked') ? 1 : 0;
        mUnits = $('#units1').prop('checked') ? 1 : 0;
		mBlink = $('#blink1').prop('checked') ? 1 : 0;
		mDateFormat = $('#dateformat1').prop('checked') ? 1 : 0;
		mLanguage = $('#language').prop("selectedIndex");
		
		mGpsLat = $("#gpslat").val();
		mGpsLon = $("#gpslon").val();		

        localStorage.setItem("style", mStyle);  
        localStorage.setItem("bluetoothvibe", mBluetoothvibe); 
        localStorage.setItem("hourlyvibe", mHourlyvibe); 
        localStorage.setItem("units", mUnits); 
		localStorage.setItem("blink", mBlink); 
		localStorage.setItem("dateformat", mDateFormat); 
		localStorage.setItem("gpslat", mGpsLat); 
		localStorage.setItem("gpslon", mGpsLon); 
		localStorage.setItem("language", mLanguage); 
        
        var j = {
          style : parseInt(mStyle),
          bluetoothvibe : parseInt(mBluetoothvibe),
          hourlyvibe: parseInt(mHourlyvibe),
          units : parseInt(mUnits),
		  blink : parseInt(mBlink),
		  dateformat : parseInt(mDateFormat),
		  language : parseInt(mLanguage),
		  gpslat: parseFloat(mGpsLat),
		  gpslon: parseFloat(mGpsLon)
        };
        
        //window.location.href = "pebblejs://close#" + JSON.stringify(j);

        e.preventDefault();

    var return_to = getQueryParam('return_to', 'pebblejs://close#');
      document.location = return_to + encodeURIComponent(JSON.stringify(j));



      });
  </script>
</body>
</html>